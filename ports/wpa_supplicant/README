patches courtesy of the Sabotage and rlsd projects
Thanks!

delpkg() {
    sanity_check
    pkgname="$1"
    grep "$pkgname" "$boredb" > /dev/null 2>&1 || \
        die "$pkgname is not installed"

    # go through $pkgs/pkgname, deleting files as we go
    # afterwards, remove its symlink in the root
    find "$pkgs"/$pkgname -type f -o -type l | while read -r file ; do
        rm $file
        file=${file#$pkgs/$pkgname}
        test_link $file || rm -f "$file"
    done
    # recurse through dirs in reverse, removing empty dirs as we go
    find "$pkgs"/$pkgname ! -path "$pkgs"/$pkgname -type d | \
            tac | while read -r dir ; do
        is_empty "$dir" && rmdir "$dir"
        dir=${dir#$pkgs/$pkgname}
        is_empty "$dir" && rmdir "$dir"
    done
    rmdir "$pkgs"/$pkgname

    del_db $pkgname
    clean

    msg "$pkgname deleted"
    unset pkgname file dir
}
